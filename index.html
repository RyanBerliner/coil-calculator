<form style="margin: 1rem 0;">
  <label style="display: block">
    Rider Weight (lbs)
    <input type="number" name="rider-weight" value="145">
  </label>
  <label style="display: block">
    Rear wheel travel (mm)
    <input type="number" name="travel" value="160">
  </label>
  <label style="display: block">
    Shock stroke (mm)
    <input type="number" name="stroke" value="60">
  </label>
  <label style="display: block">
    Preferred Sag (%)
    <input type="number" name="sag" value="27">
  </label>
</form>

<div>Solved spring weight: <span id="spring-weight"></span></div>

<script>
  const targetSagDistNode = document.getElementById('target-sag-dist');
  const springWeightNode = document.getElementById('spring-weight');
  const form = document.querySelector('form');

  let riderWeight = 0;
  let wheelTravel = 0;
  let stroke = 0;
  let sag = 0;
  let springWeight = 0;
  
  document.addEventListener('change', calculateWeight);

  form.addEventListener('submit', function(event) {
    event.preventDefault();
    calculateWeight();
  });

  function calculateWeight() {
    const data = new FormData(form);
    riderWeight = parseInt(data.get('rider-weight'));
    wheelTravel = parseInt(data.get('travel'));
    stroke = parseInt(data.get('stroke'));
    sag = parseInt(data.get('sag'));

    const leverage = wheelTravel / stroke;
    // TODO: add in average weight of the bike itself?
    const rearTireBias = 0.65; // the rear wheel supports 65% of the riders weight
    const normWeight = riderWeight  * leverage * rearTireBias;
    const targetSagDistance = stroke * sag / 100; 

    // hooks law to solve for the spring rate
    // F = k*x
    // F   force
    // k   spring rate
    // x   deformation (sometimes called displacement)

    // normWeight = springWeight * targetSagDistance;
    springWeight = normWeight / targetSagDistance; // lbs/mm
    springWeight *= 25.4 // lbs/in
    springWeightNode.innerHTML = springWeight;
  }

  calculateWeight();
</script>
